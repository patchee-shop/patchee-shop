{"ast":null,"code":"import _slicedToArray from\"/Users/nikitaspiridonov/Documents/Patchee Shop/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useState,useEffect}from\"react\";import{Context}from\"../../Context\";import PostGenerator from\"./PostGenerator\";import html2canvas from\"html2canvas\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ContactsWindow(_ref){var requestOrder=_ref.requestOrder,cartItems=_ref.cartItems,records=_ref.records;var _useContext=useContext(Context),userPhone=_useContext.userPhone,setUserPhone=_useContext.setUserPhone,userName=_useContext.userName,setUserName=_useContext.setUserName,leftEmptyPhone=_useContext.leftEmptyPhone,setLeftEmptyPhone=_useContext.setLeftEmptyPhone,isContactsWindowShown=_useContext.isContactsWindowShown,setIsContactsWindowShown=_useContext.setIsContactsWindowShown;var handlePhone=function handlePhone(event){return setUserPhone(event.target.value);};var handleName=function handleName(event){return setUserName(event.target.value);};var _useState=useState([]),_useState2=_slicedToArray(_useState,2),pictures=_useState2[0],setPictures=_useState2[1];useEffect(function(){setPictures(Object.entries(cartItems).map(function(_ref2){var _ref3=_slicedToArray(_ref2,2),key=_ref3[0],value=_ref3[1];return Object.keys(cartItems).length&&records.length?records.filter(function(r){return r.id===key;})[0].fields.Фото[0].url:[];}));},[cartItems]);var generatePost=function generatePost(){html2canvas(document.querySelector('.post-generator'),{allowTaint:true,useCORS:true}).then(function(canvas){saveAs(canvas.toDataURL(),\"\".concat(userName,\".png\"));});};function saveAs(uri,filename){var link=document.createElement('a');if(typeof link.download==='string'){link.href=uri;link.download=filename;document.body.appendChild(link);link.click();document.body.removeChild(link);}else{window.open(uri);}}return/*#__PURE__*/_jsxs(\"div\",{className:\"contacts-window \".concat(isContactsWindowShown),children:[/*#__PURE__*/_jsx(PostGenerator,{userPhone:userPhone,userName:userName,pictures:pictures}),/*#__PURE__*/_jsx(\"p\",{className:\"\".concat(leftEmptyPhone),children:\"\\u041D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430 \\u0434\\u043B\\u044F \\u0441\\u0432\\u044F\\u0437\\u0438\"}),/*#__PURE__*/_jsx(\"input\",{className:\"userPhone\",type:\"text\",name:\"userPhone\",value:userPhone,onChange:handlePhone,placeholder:\"+7\",autoFocus:true}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0418\\u043C\\u044F\"}),/*#__PURE__*/_jsx(\"input\",{className:\"useName\",type:\"text\",name:\"useName\",value:userName,onChange:handleName,autoFocus:false}),/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper\",children:[/*#__PURE__*/_jsx(\"button\",{id:\"download\",className:\"send\",onClick:function onClick(){return!(userPhone.includes(\"://\")||userPhone.includes(\"?arina\"))?userPhone.length>=10?requestOrder():setLeftEmptyPhone(\"empty\"):generatePost();},children:\"\\u0421\\u0434\\u0435\\u043B\\u0430\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel\",onClick:function onClick(){return setIsContactsWindowShown(\"hidden\");},children:\"\\u041D\\u0430\\u0437\\u0430\\u0434\"})]})]});}","map":{"version":3,"sources":["/Users/nikitaspiridonov/Documents/Patchee Shop/src/components/elements/ContactsWindow.js"],"names":["useContext","useState","useEffect","Context","PostGenerator","html2canvas","ContactsWindow","requestOrder","cartItems","records","userPhone","setUserPhone","userName","setUserName","leftEmptyPhone","setLeftEmptyPhone","isContactsWindowShown","setIsContactsWindowShown","handlePhone","event","target","value","handleName","pictures","setPictures","Object","entries","map","key","keys","length","filter","r","id","fields","Фото","url","generatePost","document","querySelector","allowTaint","useCORS","then","canvas","saveAs","toDataURL","uri","filename","link","createElement","download","href","body","appendChild","click","removeChild","window","open","includes"],"mappings":"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","sourcesContent":["import { useContext, useState, useEffect } from \"react\"\nimport { Context } from \"../../Context\"\nimport PostGenerator from \"./PostGenerator\"\nimport html2canvas from \"html2canvas\"\n\nexport default function ContactsWindow({requestOrder, cartItems, records}) {\n\n    const {\n        userPhone,\n        setUserPhone,\n        userName,\n        setUserName,\n        leftEmptyPhone,\n        setLeftEmptyPhone,\n        isContactsWindowShown,\n        setIsContactsWindowShown\n    } = useContext(Context)\n\n    const handlePhone = (event) => setUserPhone((event.target.value))\n    const handleName = (event) => setUserName((event.target.value))\n    const [pictures, setPictures] = useState([])\n\n    useEffect(() => {\n        setPictures(\n            Object.entries(cartItems).map(([key, value]) => (\n                (Object.keys(cartItems).length && records.length)?\n                (records).filter(r => r.id === key)[0].fields.Фото[0].url\n                : []\n            ))\n        )\n    }, [cartItems])\n\n    const generatePost = () => {\n        html2canvas(document.querySelector('.post-generator'), {allowTaint: true,\n            useCORS: true}).then((canvas) => {\n            saveAs(canvas.toDataURL(), `${userName}.png`);\n        });\n    }\n    \n    function saveAs(uri, filename) {\n        const link = document.createElement('a');\n        if (typeof link.download === 'string') {\n            link.href = uri;\n            link.download = filename;\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n        } else {\n            window.open(uri);\n        }\n    }\n\n    \n\n    return (\n        <div className={`contacts-window ${isContactsWindowShown}`}>\n            <PostGenerator\n                userPhone={userPhone}\n                userName={userName}\n                pictures={pictures}\n            />\n            <p className={`${leftEmptyPhone}`}>Номер телефона для связи</p>\n                <input\n                    className=\"userPhone\"\n                    type=\"text\"\n                    name=\"userPhone\"\n                    value={userPhone}\n                    onChange={handlePhone}\n                    placeholder=\"+7\"\n                    autoFocus={true}\n                />\n            <p>Имя</p>\n                <input\n                    className=\"useName\"\n                    type=\"text\"\n                    name=\"useName\"\n                    value={userName}\n                    onChange={handleName}\n                    autoFocus={false}\n                />\n            <div className=\"wrapper\">\n                <button\n                    id=\"download\"\n                    className=\"send\"\n                    onClick={\n                        () =>\n                        !(userPhone.includes(\"://\") || userPhone.includes(\"?arina\"))?\n                            userPhone.length >= 10?\n                            requestOrder() :\n                            setLeftEmptyPhone(\"empty\")\n                        : generatePost()\n                    }\n                >\n                    Сделать заказ\n                </button>\n                <button\n                    className=\"cancel\"\n                    onClick={() => setIsContactsWindowShown(\"hidden\")}\n                >\n                    Назад\n                </button>\n            </div>\n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}